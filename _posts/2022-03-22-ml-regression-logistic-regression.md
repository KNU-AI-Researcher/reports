---
keywords: fastai
description: 2022.03.20 
title: "[MachineLearning] Regression Analysis - Logistic Regression"
toc: false
badges: false
comments: false
categories: [regression analysis]
hide_{github,colab,binder,deepnote}_badge: true
nb_path: _notebooks/ml-regression-logistic-regression.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/ml-regression-logistic-regression.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Content creators:</strong> 이중원</p>
<p><strong>Content reviewers:</strong></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="1.-Overview">1. Overview<a class="anchor-link" href="#1.-Overview"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Logistic-Regression&#46976;?">Logistic Regression&#46976;?<a class="anchor-link" href="#Logistic-Regression&#46976;?"> </a></h3><ul>
<li><p>Regression기법을 분류 문제로 확장한 것</p>
</li>
<li><p>이항 형태의 범주형 데이터인 경우, 사용가능 ex) 양성/음성, 합격/불합격</p>
</li>
<li><p>입력 값이 각 클래스에 속하는 확률값을 회귀분석으로 예측</p>
</li>
</ul>
<h3 id="Odds">Odds<a class="anchor-link" href="#Odds"> </a></h3><ul>
<li><p>임의의 사건 X가 발생하지 않을 확률 대비 일어날 확률의 비율</p>
</li>
<li><p>$Odds = {P(y=1|x)\over {1-P(y=1|x)}} = exp(mx + b)$</p>
</li>
</ul>
<h3 id="Logistic-Function-(Sigmoid-Function)">Logistic Function (Sigmoid Function)<a class="anchor-link" href="#Logistic-Function-(Sigmoid-Function)"> </a></h3><ul>
<li>𝑥 ∈ (−∞,∞)를 −1,1 범위로 매핑하는 S자형 함수</li>
<li>$f(x) = {1\over {1 + \exp(-x)}}$ = $exp(x)\over {1 + \exp(x)}$</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="2.-Example">2. Example<a class="anchor-link" href="#2.-Example"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#45936;&#51060;&#53552;&#49483;-&#51456;&#48708;">&#45936;&#51060;&#53552;&#49483; &#51456;&#48708;<a class="anchor-link" href="#&#45936;&#51060;&#53552;&#49483;-&#51456;&#48708;"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>

<span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_valid</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_valid</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((120, 4), (120,), (30, 4), (30,))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#54617;&#49845;">&#54617;&#49845;<a class="anchor-link" href="#&#54617;&#49845;"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classifier</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">classifier</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/Users/jwon/opt/anaconda3/lib/python3.8/site-packages/sklearn/linear_model/_logistic.py:763: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  n_iter_i = _check_optimize_result(
</pre>
</div>
</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>LogisticRegression(random_state=0)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="&#50696;&#52769;">&#50696;&#52769;<a class="anchor-link" href="#&#50696;&#52769;"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">y_pred</span> <span class="o">=</span> <span class="n">classifier</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)</span>
<span class="n">y_pred</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([[6.16121922e-07, 2.15069658e-02, 9.78492418e-01],
       [2.24813541e-04, 1.44106469e-01, 8.55668717e-01],
       [9.86872166e-01, 1.31278254e-02, 8.45196341e-09],
       [7.42905537e-02, 9.15190175e-01, 1.05192710e-02],
       [6.17130899e-02, 9.34883255e-01, 3.40365509e-03],
       [9.85451789e-01, 1.45481989e-02, 1.22669080e-08],
       [9.83349822e-01, 1.66501582e-02, 2.00523225e-08],
       [9.74561843e-01, 2.54381352e-02, 2.13873436e-08],
       [1.05323138e-06, 2.92859163e-02, 9.70713030e-01],
       [4.60507545e-03, 8.28495273e-01, 1.66899652e-01],
       [2.90757993e-02, 9.57199786e-01, 1.37244147e-02],
       [5.07575743e-05, 5.38960827e-02, 9.46053160e-01],
       [2.38861710e-02, 9.59412646e-01, 1.67011834e-02],
       [3.74400885e-06, 1.20910117e-02, 9.87905244e-01],
       [9.76403956e-01, 2.35960160e-02, 2.74985641e-08],
       [9.76299518e-01, 2.37004423e-02, 3.95390327e-08],
       [9.52336822e-01, 4.76629417e-02, 2.36333757e-07],
       [5.73850109e-04, 4.81120782e-01, 5.18305368e-01],
       [9.81557938e-01, 1.84420425e-02, 1.96011616e-08],
       [1.01003329e-02, 7.51043736e-01, 2.38855931e-01],
       [1.67803358e-05, 1.42899971e-01, 8.57083248e-01],
       [9.73880934e-01, 2.61190258e-02, 3.98647797e-08],
       [8.45573758e-03, 9.35096103e-01, 5.64481595e-02],
       [6.91704414e-03, 8.60176111e-01, 1.32906844e-01],
       [3.84852525e-04, 4.50294871e-01, 5.49320276e-01],
       [1.11451716e-03, 8.01459697e-01, 1.97425786e-01],
       [6.74370685e-05, 4.30887311e-02, 9.56843832e-01],
       [6.18950666e-05, 1.89381057e-01, 8.10557048e-01],
       [9.78683149e-01, 2.13168316e-02, 1.91861458e-08],
       [4.82177753e-06, 5.19363140e-02, 9.48058864e-01]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">classifier</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.9666666666666667</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

